window.emujList = {
    "smile": {
        ":smile:": "😄",":smiley:": "😃",":grinning:": "😀",":blush:": "😊",":relaxed:": "☺️",":wink:": "😉",":heart_eyes:": "😍",":kissing_heart:": "😘",":kissing_closed_eyes:": "😚",":kissing:": "😗",":kissing_smiling_eyes:": "😙",":stuck_out_tongue_winking_eye:": "😜",":stuck_out_tongue_closed_eyes:": "😝",":stuck_out_tongue:": "😛",":flushed:": "😳",":grin:": "😁",":pensive:": "😔",":relieved:": "😌",":unamused:": "😒",":disappointed:": "😞",":persevere:": "😣",":cry:": "😢",":joy:": "😂",":sob:": "😭",":sleepy:": "😪",":disappointed_relieved:": "😥",":cold_sweat:": "😰",":sweat_smile:": "😅",":sweat:": "😓",":weary:": "😩",":tired_face:": "😫",":fearful:": "😨",":scream:": "😱",":angry:": "😠",":rage:": "😡",":triumph:": "😤",":confounded:": "😖",":yum:": "😋",":mask:": "😷",":sunglasses:": "😎",":sleeping:": "😴",":dizzy_face:": "😵",":astonished:": "😲",":worried:": "😟",":frowning:": "😦",":anguished:": "😧",":smiling_imp:": "😈",":imp:": "👿",":open_mouth:": "😮",":grimacing:": "😬",":neutral_face:": "😐",":confused:": "😕",":hushed:": "😯",":no_mouth:": "😶",":innocent:": "😇",":smirk:": "😏",":expressionless:": "😑",":man_with_gua_pi_mao:": "👲",":man_with_turban:": "👳",":guardsman:": "💂",":baby:": "👶",":boy:": "👦",":girl:": "👧",":man:": "👨",":woman:": "👩",":older_man:": "👴",":older_woman:": "👵",":angel:": "👼",":princess:": "👸",":smiley_cat:": "😺",":smile_cat:": "😸",":heart_eyes_cat:": "😻",":kissing_cat:": "😽",":smirk_cat:": "😼",":scream_cat:": "🙀",":crying_cat_face:": "😿",":joy_cat:": "😹",":pouting_cat:": "😾",":japanese_ogre:": "👹",":japanese_goblin:": "👺",":see_no_evil:": "🙈",":hear_no_evil:": "🙉",":speak_no_evil:": "🙊",":skull:": "💀",":alien:": "👽",":fire:": "🔥",":sparkles:": "✨",":star2:": "🌟",":dizzy:": "💫",":boom:": "💥",":anger:": "💢",":sweat_drops:": "💦",":droplet:": "💧",":zzz:": "💤",":dash:": "💨",":ear:": "👂",":eyes:": "👀",":nose:": "👃",":tongue:": "👅",":lips:": "👄",":+1:": "👍",":-1:": "👎",":ok_hand:": "👌",":facepunch:": "👊",":fist:": "✊",":v:": "✌",":wave:": "👋",":open_hands:": "👐",":point_up_2:": "👆",":point_down:": "👇",":point_right:": "👉",":point_left:": "👈",":raised_hands:": "🙌",":pray:": "🙏",":point_up:": "☝",":clap:": "👏",":muscle:": "💪",":dancer:": "💃",":couple:": "👫",":two_men_holding_hands:": "👬",":two_women_holding_hands:": "👭",":ok_woman:": "🙆",":nail_care:": "💅",":bride_with_veil:": "👰",":tophat:": "🎩",":crown:": "👑",":womans_hat:": "👒",":athletic_shoe:": "👟",":mans_shoe:": "👞",":sandal:": "👡",":high_heel:": "👠",":boot:": "👢",":necktie:": "👔",":womans_clothes:": "👚",":dress:": "👗",":running_shirt_with_sash:": "🎽",":jeans:": "👖",":kimono:": "👘",":bikini:": "👙",":briefcase:": "💼",":handbag:": "👜",":pouch:": "👝",":purse:": "👛",":eyeglasses:": "👓",":ribbon:": "🎀",":closed_umbrella:": "🌂",":lipstick:": "💄",":yellow_heart:": "💛",":blue_heart:": "💙",":purple_heart:": "💜",":green_heart:": "💚",":heart:": "❤️",":broken_heart:": "💔",":heartpulse:": "💗",":heartbeat:": "💓",":two_hearts:": "💕",":sparkling_heart:": "💖",":revolving_hearts:": "💞",":cupid:": "💘",":love_letter:": "💌",":kiss:": "💋",":ring:": "💍",":gem:": "💎",":bust_in_silhouette:": "👤",":busts_in_silhouette:": "👥",":speech_balloon:": "💬",":footprints:": "👣",":thought_balloon:": "💭"
    },
    "flower": {
        ":dog:": "🐶",":wolf:": "🐺",":cat:": "🐱",":mouse:": "🐭",":hamster:": "🐹",":rabbit:": "🐰",":frog:": "🐸",":tiger:": "🐯",":koala:": "🐨",":bear:": "🐻",":pig:": "🐷",":pig_nose:": "🐽",":cow:": "🐮",":boar:": "🐗",":monkey_face:": "🐵",":monkey:": "🐒",":horse:": "🐴",":sheep:": "🐑",":elephant:": "🐘",":panda_face:": "🐼",":penguin:": "🐧",":bird:": "🐦",":baby_chick:": "🐤",":hatched_chick:": "🐥",":hatching_chick:": "🐣",":chicken:": "🐔",":snake:": "🐍",":turtle:": "🐢",":bug:": "🐛",":ant:": "🐜",":beetle:": "🐞",":snail:": "🐌",":octopus:": "🐙",":shell:": "🐚",":tropical_fish:": "🐠",":fish:": "🐟",":dolphin:": "🐬",":whale:": "🐳",":whale2:": "🐋",":cow2:": "🐄",":ram:": "🐏",":rat:": "🐀",":water_buffalo:": "🐃",":tiger2:": "🐅",":rabbit2:": "🐇",":dragon:": "🐉",":racehorse:": "🐎",":goat:": "🐐",":rooster:": "🐓",":dog2:": "🐕",":pig2:": "🐖",":mouse2:": "🐁",":ox:": "🐂",":dragon_face:": "🐲",":blowfish:": "🐡",":crocodile:": "🐊",":camel:": "🐫",":dromedary_camel:": "🐪",":leopard:": "🐆",":cat2:": "🐈",":poodle:": "🐩",":bouquet:": "💐",":cherry_blossom:": "🌸",":tulip:": "🌷",":four_leaf_clover:": "🍀",":rose:": "🌹",":sunflower:": "🌻",":hibiscus:": "🌺",":maple_leaf:": "🍁",":leaves:": "🍃",":fallen_leaf:": "🍂",":herb:": "🌿",":ear_of_rice:": "🌾",":mushroom:": "🍄",":cactus:": "🌵",":palm_tree:": "🌴",":evergreen_tree:": "🌲",":deciduous_tree:": "🌳",":chestnut:": "🌰",":seedling:": "🌱",":blossom:": "🌼",":globe_with_meridians:": "🌐",":sun_with_face:": "🌞",":full_moon_with_face:": "🌝",":new_moon_with_face:": "🌚",":new_moon:": "🌑",":waxing_crescent_moon:": "🌒",":first_quarter_moon:": "🌓",":full_moon:": "🌕",":waning_gibbous_moon:": "🌖",":last_quarter_moon:": "🌗",":waning_crescent_moon:": "🌘",":last_quarter_moon_with_face:": "🌜",":first_quarter_moon_with_face:": "🌛",":crescent_moon:": "🌙",":earth_africa:": "🌍",":earth_americas:": "🌎",":earth_asia:": "🌏",":volcano:": "🌋",":milky_way:": "🌌",":stars:": "🌠",":star:": "⭐",":sunny:": "☀️",":partly_sunny:": "⛅",":cloud:": "☁️",":zap:": "⚡",":umbrella:": "☔",":snowflake:": "❄️",":snowman:": "⛄",":cyclone:": "🌀",":foggy:": "🌁",":rainbow:": "🌈",":ocean:": "🌊"
    },
    "bell": {
        ":bamboo:": "🎍",":gift_heart:": "💝",":dolls:": "🎎",":school_satchel:": "🎒",":mortar_board:": "🎓",":flags:": "🎏",":fireworks:": "🎆",":sparkler:": "🎇",":wind_chime:": "🎐",":rice_scene:": "🎑",":jack_o_lantern:": "🎃",":ghost:": "👻",":santa:": "🎅",":christmas_tree:": "🎄",":gift:": "🎁",":tanabata_tree:": "🎋",":tada:": "🎉",":confetti_ball:": "🎊",":balloon:": "🎈",":crossed_flags:": "🎌",":crystal_ball:": "🔮",":movie_camera:": "🎥",":camera:": "📷",":video_camera:": "📹",":vhs:": "📼",":cd:": "💿",":dvd:": "📀",":minidisc:": "💽",":floppy_disk:": "💾",":computer:": "💻",":iphone:": "📱",":phone:": "☎️",":telephone_receiver:": "📞",":pager:": "📟",":fax:": "📠",":satellite:": "📡",":tv:": "📺",":radio:": "📻",":loud_sound:": "🔊",":sound:": "🔉",":speaker:": "🔈",":mute:": "🔇",":bell:": "🔔",":no_bell:": "🔕",":mega:": "📣",":loudspeaker:": "📢",":hourglass_flowing_sand:": "⏳",":hourglass:": "⌛",":alarm_clock:": "⏰",":watch:": "⌚",":unlock:": "🔓",":lock:": "🔒",":lock_with_ink_pen:": "🔏",":closed_lock_with_key:": "🔐",":key:": "🔑",":mag_right:": "🔎",":bulb:": "💡",":flashlight:": "🔦",":high_brightness:": "🔆",":low_brightness:": "🔅",":electric_plug:": "🔌",":battery:": "🔋",":mag:": "🔍",":bath:": "🛀",":bathtub:": "🛁",":shower:": "🚿",":toilet:": "🚽",":wrench:": "🔧",":nut_and_bolt:": "🔩",":hammer:": "🔨",":door:": "🚪",":smoking:": "🚬",":bomb:": "💣",":gun:": "🔫",":hocho:": "🔪",":pill:": "💊",":syringe:": "💉",":moneybag:": "💰",":yen:": "💴",":dollar:": "💵",":pound:": "💷",":euro:": "💶",":credit_card:": "💳",":money_with_wings:": "💸",":calling:": "📲",":e-mail:": "📧",":inbox_tray:": "📥",":outbox_tray:": "📤",":email:": "✉️",":envelope_with_arrow:": "📩",":incoming_envelope:": "📨",":postal_horn:": "📯",":mailbox:": "📫",":mailbox_closed:": "📪",":mailbox_with_mail:": "📬",":mailbox_with_no_mail:": "📭",":postbox:": "📮",":package:": "📦",":memo:": "📝",":page_facing_up:": "📄",":page_with_curl:": "📃",":bookmark_tabs:": "📑",":bar_chart:": "📊",":chart_with_upwards_trend:": "📈",":chart_with_downwards_trend:": "📉",":scroll:": "📜",":clipboard:": "📋",":date:": "📅",":calendar:": "📆",":card_index:": "📇",":file_folder:": "📁",":open_file_folder:": "📂",":scissors:": "✂️",":pushpin:": "📌",":paperclip:": "📎",":black_nib:": "✒️",":pencil2:": "✏️",":straight_ruler:": "📏",":triangular_ruler:": "📐",":closed_book:": "📕",":green_book:": "📗",":blue_book:": "📘",":orange_book:": "📙",":notebook:": "📓",":notebook_with_decorative_cover:": "📔",":ledger:": "📒",":books:": "📚",":bookmark:": "🔖",":name_badge:": "📛",":microscope:": "🔬",":telescope:": "🔭",":newspaper:": "📰",":art:": "🎨",":clapper:": "🎬",":microphone:": "🎤",":headphones:": "🎧",":musical_score:": "🎼",":musical_note:": "🎵",":notes:": "🎶",":musical_keyboard:": "🎹",":violin:": "🎻",":trumpet:": "🎺",":saxophone:": "🎷",":guitar:": "🎸",":space_invader:": "👾",":video_game:": "🎮",":black_joker:": "🃏",":flower_playing_cards:": "🎴",":mahjong:": "🀄",":game_die:": "🎲",":dart:": "🎯",":football:": "🏈",":basketball:": "🏀",":soccer:": "⚽",":baseball:": "⚾",":tennis:": "🎾",":8ball:": "🎱",":rugby_football:": "🏉",":bowling:": "🎳",":golf:": "⛳",":checkered_flag:": "🏁",":horse_racing:": "🏇",":trophy:": "🏆",":ski:": "🎿",":snowboarder:": "🏂",":fishing_pole_and_fish:": "🎣",":coffee:": "☕",":tea:": "🍵",":sake:": "🍶",":baby_bottle:": "🍼",":beer:": "🍺",":beers:": "🍻",":cocktail:": "🍸",":tropical_drink:": "🍹",":wine_glass:": "🍷",":fork_and_knife:": "🍴",":pizza:": "🍕",":hamburger:": "🍔",":fries:": "🍟",":poultry_leg:": "🍗",":meat_on_bone:": "🍖",":spaghetti:": "🍝",":curry:": "🍛",":fried_shrimp:": "🍤",":bento:": "🍱",":sushi:": "🍣",":fish_cake:": "🍥",":rice_ball:": "🍙",":rice_cracker:": "🍘",":rice:": "🍚",":ramen:": "🍜",":stew:": "🍲",":oden:": "🍢",":dango:": "🍡",":egg:": "🥚",":bread:": "🍞",":doughnut:": "🍩",":custard:": "🍮",":icecream:": "🍦",":ice_cream:": "🍨",":shaved_ice:": "🍧",":birthday:": "🎂",":cake:": "🍰",":cookie:": "🍪",":chocolate_bar:": "🍫",":candy:": "🍬",":lollipop:": "🍭",":honey_pot:": "🍯",":apple:": "🍎",":green_apple:": "🍏",":tangerine:": "🍊",":lemon:": "🍋",":cherries:": "🍒",":grapes:": "🍇",":watermelon:": "🍉",":strawberry:": "🍓",":peach:": "🍑",":melon:": "🍈",":banana:": "🍌",":pear:": "🍐",":pineapple:": "🍍",":sweet_potato:": "🍠",":eggplant:": "🍆",":tomato:": "🍅",":corn:": "🌽"
    },
    "car": {
        ":house:": "🏠",":house_with_garden:": "🏡",":school:": "🏫",":office:": "🏢",":post_office:": "🏣",":hospital:": "🏥",":bank:": "🏦",":convenience_store:": "🏪",":love_hotel:": "🏩",":hotel:": "🏨",":wedding:": "💒",":church:": "⛪",":department_store:": "🏬",":european_post_office:": "🏤",":city_sunrise:": "🌇",":city_sunset:": "🌆",":japanese_castle:": "🏯",":european_castle:": "🏰",":tent:": "⛺",":factory:": "🏭",":tokyo_tower:": "🗼",":japan:": "🗾",":mount_fuji:": "🗻",":sunrise_over_mountains:": "🌄",":sunrise:": "🌅",":night_with_stars:": "🌃",":statue_of_liberty:": "🗽",":bridge_at_night:": "🌉",":carousel_horse:": "🎠",":ferris_wheel:": "🎡",":fountain:": "⛲",":roller_coaster:": "🎢",":ship:": "🚢",":speedboat:": "🚤",":anchor:": "⚓",":rocket:": "🚀",":airplane:": "✈️",":seat:": "💺",":helicopter:": "🚁",":steam_locomotive:": "🚂",":tram:": "🚊",":station:": "🚉",":mountain_railway:": "🚞",":train2:": "🚆",":bullettrain_side:": "🚄",":bullettrain_front:": "🚅",":light_rail:": "🚈",":metro:": "🚇",":monorail:": "🚝",":railway_car:": "🚃",":train:": "🚋",":trolleybus:": "🚎",":bus:": "🚌",":oncoming_bus:": "🚍",":blue_car:": "🚙",":oncoming_automobile:": "🚘",":taxi:": "🚕",":oncoming_taxi:": "🚖",":articulated_lorry:": "🚛",":truck:": "🚚",":rotating_light:": "🚨",":police_car:": "🚓",":oncoming_police_car:": "🚔",":fire_engine:": "🚒",":ambulance:": "🚑",":minibus:": "🚐",":bike:": "🚲",":aerial_tramway:": "🚡",":suspension_railway:": "🚟",":mountain_cableway:": "🚠",":tractor:": "🚜",":barber:": "💈",":busstop:": "🚏",":ticket:": "🎫",":vertical_traffic_light:": "🚦",":traffic_light:": "🚥",":warning:": "⚠️",":construction:": "🚧",":beginner:": "🔰",":fuelpump:": "⛽",":izakaya_lantern:": "🏮",":slot_machine:": "🎰",":hotsprings:": "♨️",":moyai:": "🗿",":circus_tent:": "🎪",":performing_arts:": "🎭",":round_pushpin:": "📍",":triangular_flag_on_post:": "🚩",":jp:": "🇯🇵",":kr:": "🇰🇷",":de:": "🇩🇪",":cn:": "🇨🇳",":us:": "🇺🇸",":fr:": "🇫🇷",":es:": "🇪🇸",":it:": "🇮🇹",":ru:": "🇷🇺"
    },
    "hash": {
        ":one:": "1️⃣",":two:": "2️⃣",":three:": "3️⃣",":four:": "4️⃣",":five:": "5️⃣",":six:": "6️⃣",":seven:": "7️⃣",":eight:": "8️⃣",":nine:": "9️⃣",":zero:": "0️⃣",":keycap_ten:": "🔟",":1234:": "🔢",":hash:": "#️⃣",":symbols:": "🔣",":arrow_up:": "⬆️",":arrow_down:": "⬇️",":arrow_left:": "⬅️",":arrow_right:": "➡️",":capital_abcd:": "🔠",":abcd:": "🔡",":abc:": "🔤",":arrow_upper_right:": "↗️",":arrow_upper_left:": "↖️",":arrow_lower_right:": "↘️",":arrow_lower_left:": "↙️",":left_right_arrow:": "↔️",":arrow_up_down:": "↕️",":arrows_counterclockwise:": "🔄",":arrow_backward:": "◀️",":arrow_forward:": "▶️",":arrow_up_small:": "🔼",":arrow_down_small:": "🔽",":leftwards_arrow_with_hook:": "↩️",":arrow_right_hook:": "↪️",":information_source:": "ℹ️",":rewind:": "⏪",":fast_forward:": "⏩",":arrow_double_up:": "⏫",":arrow_double_down:": "⏬",":arrow_heading_down:": "⤵️",":arrow_heading_up:": "⤴️",":ok:": "🆗",":twisted_rightwards_arrows:": "🔀",":repeat:": "🔁",":repeat_one:": "🔂",":new:": "🆕",":up:": "🆙",":cool:": "🆒",":free:": "🆓",":ng:": "🆖",":signal_strength:": "📶",":cinema:": "🎦",":koko:": "🈁",":u6307:": "🈯",":u7a7a:": "🈳",":u6e80:": "🈵",":u5408:": "🈴",":u7981:": "🈲",":ideograph_advantage:": "🉐",":u5272:": "🈹",":u55b6:": "🈺",":u6709:": "🈶",":u7121:": "🈚",":restroom:": "🚻",":mens:": "🚹",":womens:": "🚺",":baby_symbol:": "🚼",":wc:": "🚾",":potable_water:": "🚰",":put_litter_in_its_place:": "🚮",":parking:": "🅿️",":wheelchair:": "♿",":no_smoking:": "🚭",":u6708:": "🈷️",":u7533:": "🈸",":sa:": "🈂️",":m:": "Ⓜ️",":passport_control:": "🛂",":baggage_claim:": "🛄",":left_luggage:": "🛅",":customs:": "🛃",":accept:": "🉑",":secret:": "㊙️",":congratulations:": "㊗️",":cl:": "🆑",":sos:": "🆘",":id:": "🆔",":no_entry_sign:": "🚫",":underage:": "🔞",":no_mobile_phones:": "📵",":do_not_litter:": "🚯",":non-potable_water:": "🚱",":no_bicycles:": "🚳",":no_pedestrians:": "🚷",":children_crossing:": "🚸",":no_entry:": "⛔",":eight_spoked_asterisk:": "✳️",":sparkle:": "❇️",":negative_squared_cross_mark:": "❎",":white_check_mark:": "✅",":eight_pointed_black_star:": "✴️",":heart_decoration:": "💟",":vs:": "🆚",":vibration_mode:": "📳",":mobile_phone_off:": "📴",":a:": "🅰️",":b:": "🅱️",":ab:": "🆎",":o2:": "🅾️",":diamond_shape_with_a_dot_inside:": "💠",":loop:": "➿",":recycle:": "♻️",":aries:": "♈",":taurus:": "♉",":gemini:": "♊",":cancer:": "♋",":leo:": "♌",":virgo:": "♍",":libra:": "♎",":scorpius:": "♏",":sagittarius:": "♐",":capricorn:": "♑",":aquarius:": "♒",":pisces:": "♓",":ophiuchus:": "⛎",":six_pointed_star:": "🔯",":atm:": "🏧",":chart:": "💹",":heavy_dollar_sign:": "💲",":currency_exchange:": "💱",":copyright:": "©️",":registered:": "®️",":tm:": "™️",":x:": "❌",":bangbang:": "‼️",":interrobang:": "⁉️",":exclamation:": "❗",":question:": "❓",":grey_exclamation:": "❕",":grey_question:": "❔",":o:": "⭕",":top:": "🔝",":end:": "🔚",":back:": "🔙",":on:": "🔛",":soon:": "🔜",":arrows_clockwise:": "🔃",":clock12:": "🕛",":clock1230:": "🕧",":clock1:": "🕐",":clock130:": "🕜",":clock2:": "🕑",":clock230:": "🕝",":clock3:": "🕒",":clock330:": "🕞",":clock4:": "🕓",":clock430:": "🕟",":clock5:": "🕔",":clock530:": "🕠",":clock6:": "🕕",":clock7:": "🕖",":clock8:": "🕗",":clock9:": "🕘",":clock10:": "🕙",":clock11:": "🕚",":clock630:": "🕡",":clock730:": "🕢",":clock830:": "🕣",":clock930:": "🕤",":clock1030:": "🕥",":clock1130:": "🕦",":heavy_multiplication_x:": "✖️",":heavy_plus_sign:": "➕",":heavy_minus_sign:": "➖",":heavy_division_sign:": "➗",":spades:": "♠️",":hearts:": "♥️",":clubs:": "♣️",":diamonds:": "♦️",":white_flower:": "💮",":100:": "💯",":heavy_check_mark:": "✔️",":ballot_box_with_check:": "☑️",":radio_button:": "🔘",":link:": "🔗",":curly_loop:": "➰",":wavy_dash:": "〰️",":part_alternation_mark:": "〽️",":trident:": "🔱",":black_medium_square:": "◼️",":white_medium_square:": "◻️",":black_medium_small_square:": "◾",":white_medium_small_square:": "◽",":black_small_square:": "▪️",":white_small_square:": "▫️",":small_red_triangle:": "🔺",":black_square_button:": "🔲",":white_square_button:": "🔳",":black_circle:": "⚫",":white_circle:": "⚪",":red_circle:": "🔴",":large_blue_circle:": "🔵",":small_red_triangle_down:": "🔻",":white_large_square:": "⬜",":black_large_square:": "⬛",":large_orange_diamond:": "🔶",":large_blue_diamond:": "🔷",":small_orange_diamond:": "🔸",":small_blue_diamond:": "🔹"
    }
};
window.emujiTabs = {
        smile :':smile:',
        flower :':cherry_blossom:',
        bell :':bamboo:',
        car :':blue_car:',
        hash :':hash:',

    }
if('undefined' == typeof emujiedAlready){
    emujiedAlready = true;
    chrome.runtime.onMessage.addListener(function(message){
        if('emujiSelect' == message.action){
            if(document.activeElement){
                //console.log(message.emuji,document.activeElement);
                insertAtCursor(document.activeElement, message.emuji)
            }
        }
    });
}
function bindAllInputs(){
    if('undefined' == typeof inputsEmujiedAlready){
        inputsEmujiedAlready = true;
        //document.body.innerHTML += '<div style="position:relative"><input type="text"></div>';
        lastFocused = null;
        var textAreas = document.querySelectorAll('textarae:not(.emujied'),
            inputs = document.querySelectorAll('input[type="text"]:not(.emujied)');
        Array.prototype.forEach.call(textAreas, function(textArea, i){
            bindInputs(textAreas);
        });
    
        Array.prototype.forEach.call(inputs, function(input, i){
            bindInputs(input);
        });
    }
}

function selectTab(par, name){
    var selected = par.getElementsByClassName('emuji-box-part-' + name);
        if(selected && selected.length){
            hideTabs(par);
            selected[0].style.display = "block";
            document.getElementsByClassName('emuji-' + name)[0].classList.add('selected') ;
        }
}
function hideTabs(par){
    var boxes = par.getElementsByClassName('emuji-box-part');
    var emujiTabs = par.getElementsByClassName('emuji-tab');
    Array.prototype.forEach.call(boxes, function(box, i){
        box.style.display = "none";
    });
    Array.prototype.forEach.call(emujiTabs, function(tab, i){
        tab.classList.remove('selected') ;
    });
}


function copySelected(par, str){
    var newValue = str.replace(/\n/,''),
        toCopy = par.getElementsByClassName('to-copy')[0];
    console.log(toCopy, par);
    toCopy.value = newValue;
    //console.log(toCopy.value.length,newValue.length,str,str[0],str[1]);

    toCopy.textContent = str;
    var selection = document.getSelection(),
        range = document.createRange();
    //  range.selectNodeContents(textarea);
    range.selectNode(toCopy);
    selection.removeAllRanges();
    selection.addRange(range);
    toCopy.classList.add('show');
    var successful = document.execCommand('copy'); 
    toCopy.classList.remove('show');
    //console.log('successful',successful, str)

}

function bindInputs(input){
    var par = document.createElement('div');
    par.classList.add('emuji-wrapper');
    wrap(input, par);
    input.addEventListener('focus', function(){
        lastFocused = this;
    });
    input.classList.add('emujied');
    //var par = input.parentElement;
    // if(!par.style.position || 'static' == par.style.position){
    //     par.style.position = "relative";
    // }
    setEmujiesBox(par);
}

function insertAtCursor(myField, myValue) {
    if (myField.selectionStart || myField.selectionStart == '0') {
        var startPos = myField.selectionStart;
        var endPos = myField.selectionEnd;
        myField.value = myField.value.substring(0, startPos)
            + myValue
            + myField.value.substring(endPos, myField.value.length);
    } else {
        myField.value += myValue;
    }
}

function setEmujiesBox(par){
    var html = '<div class="emoji-main-wrapper" style="display:none">',
        tabs = '<div class="emoji-tabs">',
        boxes = '<div class="emoji-boxes">';
    
    for(var eKey in emujList){
        var emujPartList =  emujList[eKey];
        //console.log(emujPartList, window.emujiTabs,eKey);
        boxes += '<div class="emuji-box-part emuji-box-part-' + eKey + '">';
        tabs += '<button type="button" class="emuji-tab emuji-' + eKey + '" data-name="' + eKey + '">' + emujPartList[window.emujiTabs[eKey]] + '</button>';
        for(var ePartKey in emujPartList){
            var emujPartImg =  emujPartList[ePartKey];
            boxes += '<button title="' + converToReadableName(ePartKey.replace(/:/g,'')) + '" type="button" class="emuji-button emuji-img-' + ePartKey.replace(/:/g,'') + '">';
            boxes += emujPartImg;
            boxes += '</button>';
        }
        boxes += '</div>';
    }

    tabs += '</div>';
    boxes += '</div>';
    html += tabs + boxes + '<textarea class="to-copy"></textarea>';
    html += `<style>
        .emoji-boxes,.emoji-box {
            position: relative;
            width: 250px;
        }
        .emoji-toggler {
            top: 0;
            left: 0;
            z-index: 9999999999999;
            position: absolute;
        }
        .emoji-main-wrapper .emuji-button {
            border: 0;
            background: transparent;
            font-size: 16px;
            min-width: 30px;
            border: 1px solid transparent;
        }
        button.emuji-tab {
            background: #fff;
            border: 0;
            padding: 4px 10px;
            font-size: 22px;
        }
        .emoji-tabs {
            border: 1px solid gray;
        }
        .emoji-main-wrapper .emuji-button:hover {
            background: #ff4c0045;
            color: #000;
            font-weight: bold;
            border: 1px solid gray;
        
        }
        .emoji-main-wrapper .emuji-box-part {
            position: absolute;
            top: 0;
            width: 250px;
            text-align: center;
            background: #fff;
            border: 1px solid gray;
            max-height: 250px;
            overflow-y: scroll;
        }
        .emoji-main-wrapper .to-copy{
            display:none;

        }
        .emoji-main-wrapper .to-copy.show{
            display:inline-block;
        }
        button.emuji-tab.selected {
            background: #e0e0e087;
        }
        .emuji-wrapper{
            position:relative;
            display:inline-block;
        }
        .emoji-toggler{
            border:0;
            background:#fff;
        }
        </style></div>`;

    var emojiBox = document.createElement('div');
    //console.log(html);
    emojiBox.classList.add('emoji-box');
    //console.log(par,emojiBox);
    var toggler = document.createElement('button');
    toggler.setAttribute('class','emoji-toggler')
    toggler.innerText = '😄';
    emojiBox.innerHTML = html;
    //par.appendChild(toggler);
    par.appendChild(emojiBox);
   // console.log(par.innerHtml);
    par.innerHTML = '<button type="button" class="emoji-toggler">😄</button>' + par.innerHTML;
    //par.toCopy = div.getElementsByClassName('to-copy')[0];
    var buttons = par.getElementsByClassName('emuji-button'),
        emujiTabs = par.getElementsByClassName('emuji-tab');
    //console.log(buttons, emujiTabs);
    Array.prototype.forEach.call(buttons, function(button, i){
        button.addEventListener('click', function(){
            //console.log(lastFocused,'button',button);
            var emuji = this.innerText.replace(/\n/g,''),
                input = par.getElementsByClassName('emujied')[0];
            console.log(input,'input');
            if(input){
                insertAtCursor(input ,emuji);
            }
            copySelected(par,emuji);
        });
    });
    Array.prototype.forEach.call(emujiTabs, function(tab, i){
        console.log(tab.attributes[2].value);

        tab.addEventListener('click', function(){
            selectTab(par, tab.attributes[2].value);
            
            console.log(par, tab.attributes[2].value);
        });
    });
    par.getElementsByClassName('emoji-toggler')[0].addEventListener('click', function(){
        let wrapper = par.getElementsByClassName('emoji-main-wrapper ')[0];
        //console.log(wrapper, 'wr');
        wrapper.style.display = wrapper.style.display == 'inline-block' ? 'none' : 'inline-block' ;
        
        //console.log();
    });
    selectTab(par,'smile');
}
function wrap(el, wrapper) {
    el.parentElement.insertBefore(wrapper, el);
    wrapper.appendChild(el);
    //console.log(el, wrapper)
}
//


function converToReadableName(str){
    var strArr = str.split('_'),
        strArr2 = [];
    strArr.forEach(function(str2){
        strArr2.push(str2.charAt(0).toUpperCase() + str2.slice(1));
    });
    //console.log(strArr);
    return strArr2.join(' ');
}
